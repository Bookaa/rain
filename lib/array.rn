import core

length = core.length

values = func(self)
  let i = 0
  return func()
    save self[i]
    i = i + 1

keys = func(self)
  let i = 0
  return func()
    if self[i] == null
      return

    save i
    i = i + 1

map = func(self, fn)
  let ret = table from self.metatable
  save ret
  for i in keys(self)
    ret[i] = fn(self[i])
